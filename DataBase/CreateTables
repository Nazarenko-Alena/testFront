DROP TABLE IF EXISTS categories, cuisines, users, recipes, ingredients, saved_recipes, CASCADE;

CREATE TABLE categories
(
	id_category integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	name text NOT NULL UNIQUE
);

CREATE TABLE cuisines
(
	id_cuisine integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	name text NOT NULL UNIQUE
);

CREATE TABLE users
(
	id_user integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	login text NOT NULL UNIQUE,
	password text NOT NULL,
	email text NOT NULL UNIQUE
);

CREATE TABLE recipes
(
	id_recipe integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	id_user integer NOT NULL REFERENCES users ON DELETE CASCADE ON UPDATE CASCADE,
	name text NOT NULL UNIQUE,
	image_url text NOT NULL UNIQUE,
	date_added date NOT NULL,
	cuisine integer NOT NULL REFERENCES cuisines ON DELETE CASCADE ON UPDATE CASCADE,
	category integer NOT NULL REFERENCES categories ON DELETE CASCADE ON UPDATE CASCADE,
	cooking_time integer NOT NULL,
	description text NOT NULL UNIQUE,
	recipe text NOT NULL UNIQUE
);

CREATE TABLE ingredients
(
	id_ingredient integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	id_recipe integer NOT NULL REFERENCES recipes ON DELETE CASCADE ON UPDATE CASCADE,
	name text NOT NULL,
	grams numeric NOT NULL
);

CREATE TABLE saved_recipes
(
	id integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	id_user integer NOT NULL REFERENCES users ON DELETE CASCADE ON UPDATE CASCADE,
	id_recipe integer NOT NULL REFERENCES recipes ON DELETE CASCADE ON UPDATE CASCADE
);